(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26855,        542]
NotebookOptionsPosition[     24456,        490]
NotebookOutlinePosition[     24955,        509]
CellTagsIndexPosition[     24912,        506]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Single-shot minimum mean square error for collective POMs on \[Mu] copies of \
a N00N state\
\>", "Title",
 CellChangeTimes->{{3.8172308876435714`*^9, 3.817231007939225*^9}, {
   3.817232781066066*^9, 3.817232802650195*^9}, {3.820566034238792*^9, 
   3.820566070621307*^9}, {3.8205665393998737`*^9, 3.820566595736163*^9}, {
   3.820569710714538*^9, 3.820569712649527*^9}, {3.8226005913864117`*^9, 
   3.822600594798044*^9}, {3.823878437055938*^9, 3.8238784373438587`*^9}, {
   3.823879681485977*^9, 3.8238796851410503`*^9}, {3.824814250386916*^9, 
   3.8248142508896604`*^9}, {3.825049689444072*^9, 3.8250496898239613`*^9}, {
   3.8268910285640335`*^9, 3.8268911705922213`*^9}, {3.8268912420407844`*^9, 
   3.8268912479983325`*^9}, {3.8268913606894636`*^9, 
   3.8268913620706882`*^9}, {3.8339661189791756`*^9, 3.833966119458873*^9}, {
   3.8355419490358133`*^9, 3.8355419871614604`*^9}, 3.8355420635964327`*^9, 
   3.835542095673031*^9, {3.835542336944213*^9, 3.835542358911919*^9}, {
   3.835542528703396*^9, 3.8355425669361386`*^9}, {3.8355426495313396`*^9, 
   3.835542710425622*^9}, {3.8355429999439287`*^9, 3.8355430002647376`*^9}, {
   3.8356205059793773`*^9, 3.835620529929517*^9}, {3.8356210121275096`*^9, 
   3.8356210157065525`*^9}},
 FontSize->24,ExpressionUUID->"767000d7-785a-403a-8259-7ce916f377d8"],

Cell[CellGroupData[{

Cell[" Number of copies", "Subsection",
 CellChangeTimes->{{3.817231011361639*^9, 3.817231019632612*^9}, {
   3.817231539732112*^9, 3.8172318130827694`*^9}, {3.817232041435583*^9, 
   3.8172320624640307`*^9}, {3.817232235182582*^9, 3.8172322675294228`*^9}, {
   3.8172323983898363`*^9, 3.8172323987058587`*^9}, {3.8172324540341635`*^9, 
   3.8172324592404723`*^9}, {3.8172325518477707`*^9, 3.817232673192151*^9}, {
   3.8172327685765123`*^9, 3.8172327764678965`*^9}, {3.817232812123248*^9, 
   3.8172328382303715`*^9}, {3.817232879496555*^9, 3.817232917071907*^9}, {
   3.8172330688869343`*^9, 3.817233101257606*^9}, {3.817233230341447*^9, 
   3.8172332316980023`*^9}, {3.8172336161494904`*^9, 
   3.8172336169447393`*^9}, {3.8172402845762377`*^9, 3.817240313854489*^9}, {
   3.817240700095315*^9, 3.817240713753161*^9}, {3.8355434179389277`*^9, 
   3.8355434561448793`*^9}, 3.8356206887884545`*^9},
 FontSize->18,ExpressionUUID->"134ecbef-2767-4da9-8220-3c2c8a245531"],

Cell["Remark: \[Mu] must be greater than or equal to 2. ", "Text",
 CellChangeTimes->{{3.817231011361639*^9, 3.817231019632612*^9}, {
   3.817231539732112*^9, 3.8172318130827694`*^9}, {3.817232041435583*^9, 
   3.8172320624640307`*^9}, {3.817232235182582*^9, 3.8172322675294228`*^9}, {
   3.8172323983898363`*^9, 3.8172323987058587`*^9}, {3.8172324540341635`*^9, 
   3.8172324592404723`*^9}, {3.8172325518477707`*^9, 3.817232673192151*^9}, {
   3.8172327685765123`*^9, 3.8172327764678965`*^9}, {3.817232812123248*^9, 
   3.8172328382303715`*^9}, {3.817232879496555*^9, 3.817232917071907*^9}, {
   3.8172330688869343`*^9, 3.817233101257606*^9}, {3.817233230341447*^9, 
   3.8172332316980023`*^9}, {3.8172336161494904`*^9, 
   3.8172336169447393`*^9}, {3.8172402845762377`*^9, 3.817240313854489*^9}, {
   3.817240700095315*^9, 3.817240713753161*^9}, 3.8355434179389277`*^9, {
   3.8355434662418947`*^9, 3.835543468289589*^9}, {3.835620966325029*^9, 
   3.8356209909046164`*^9}, {3.835621054888677*^9, 
   3.8356210580354853`*^9}},ExpressionUUID->"26e2b967-9acc-4da8-bbff-\
c142cf2213e7"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Mu]", "]"}], "\n", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.817231011361639*^9, 3.817231019632612*^9}, {
   3.817231539732112*^9, 3.8172318130827694`*^9}, {3.817232041435583*^9, 
   3.8172320624640307`*^9}, {3.817232235182582*^9, 3.8172322675294228`*^9}, {
   3.8172323983898363`*^9, 3.8172323987058587`*^9}, {3.8172324540341635`*^9, 
   3.8172324592404723`*^9}, {3.8172325518477707`*^9, 3.817232673192151*^9}, {
   3.8172327685765123`*^9, 3.8172327764678965`*^9}, {3.817232812123248*^9, 
   3.8172328382303715`*^9}, {3.817232879496555*^9, 3.817232917071907*^9}, {
   3.8172330688869343`*^9, 3.817233101257606*^9}, {3.817233230341447*^9, 
   3.8172332316980023`*^9}, {3.8172336161494904`*^9, 
   3.8172336169447393`*^9}, {3.8172402845762377`*^9, 3.817240313854489*^9}, {
   3.817240700095315*^9, 3.817240713753161*^9}, 3.8355434179389277`*^9, {
   3.8355434662418947`*^9, 3.835543468289589*^9}, {3.835620966325029*^9, 
   3.83562100223582*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"6a2732ea-f01e-44e8-8df7-09eb9a0ca45b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameter-dependent probe state", "Subsection",
 CellChangeTimes->{{3.817231011361639*^9, 3.817231019632612*^9}, {
   3.817231539732112*^9, 3.8172318130827694`*^9}, {3.817232041435583*^9, 
   3.8172320624640307`*^9}, {3.817232235182582*^9, 3.8172322675294228`*^9}, {
   3.8172323983898363`*^9, 3.8172323987058587`*^9}, {3.8172324540341635`*^9, 
   3.8172324592404723`*^9}, {3.8172325518477707`*^9, 3.817232673192151*^9}, {
   3.8172327685765123`*^9, 3.8172327764678965`*^9}, {3.817232812123248*^9, 
   3.8172328382303715`*^9}, {3.817232879496555*^9, 3.817232917071907*^9}, {
   3.8172330688869343`*^9, 3.817233101257606*^9}, 3.817233230341447*^9, {
   3.817233299885683*^9, 3.8172334550621214`*^9}, {3.822600602408382*^9, 
   3.8226006298354654`*^9}, {3.8226006765030003`*^9, 3.822600687443347*^9}, {
   3.8226007236837263`*^9, 3.8226007247458887`*^9}, {3.823878452924839*^9, 
   3.823878455401353*^9}, {3.825063186228921*^9, 3.825063200298081*^9}, {
   3.825063243307034*^9, 3.825063348523202*^9}, {3.8250643950303097`*^9, 
   3.825064398305263*^9}, 3.825064968397052*^9, 3.8250652855414248`*^9, {
   3.825066038626746*^9, 3.825066055934104*^9}, {3.8250728530744743`*^9, 
   3.8250728581358013`*^9}, {3.825072911882518*^9, 3.825072943181905*^9}, {
   3.825073062941679*^9, 3.8250730940906076`*^9}, 3.8268910929792085`*^9, {
   3.826891184589816*^9, 3.826891273248124*^9}, {3.8268914296469555`*^9, 
   3.826891431743919*^9}, 3.8268914679882364`*^9, {3.8355434854085155`*^9, 
   3.835543632753029*^9}, {3.8355444869606714`*^9, 3.8355445144717607`*^9}, 
   3.8356210276665754`*^9, {3.835622459377267*^9, 3.835622465400667*^9}},
 FontSize->18,ExpressionUUID->"39df1cf5-81b2-4abf-9855-8dae42055d50"],

Cell["Remark: \[OpenCurlyQuote]j\[CloseCurlyQuote] below denotes the index of \
repetition.", "Text",
 CellChangeTimes->{{3.817231011361639*^9, 3.817231019632612*^9}, {
   3.817231539732112*^9, 3.8172318130827694`*^9}, {3.817232041435583*^9, 
   3.8172320624640307`*^9}, {3.817232235182582*^9, 3.8172322675294228`*^9}, {
   3.8172323983898363`*^9, 3.8172323987058587`*^9}, {3.8172324540341635`*^9, 
   3.8172324592404723`*^9}, {3.8172325518477707`*^9, 3.817232673192151*^9}, {
   3.8172327685765123`*^9, 3.8172327764678965`*^9}, {3.817232812123248*^9, 
   3.8172328382303715`*^9}, {3.817232879496555*^9, 3.817232917071907*^9}, {
   3.8172330688869343`*^9, 3.817233101257606*^9}, 3.817233230341447*^9, {
   3.817233299885683*^9, 3.8172334550621214`*^9}, {3.822600602408382*^9, 
   3.8226006298354654`*^9}, {3.8226006765030003`*^9, 3.822600687443347*^9}, {
   3.8226007236837263`*^9, 3.8226007247458887`*^9}, {3.823878452924839*^9, 
   3.823878455401353*^9}, {3.825063186228921*^9, 3.825063200298081*^9}, {
   3.825063243307034*^9, 3.825063348523202*^9}, {3.8250643950303097`*^9, 
   3.825064398305263*^9}, 3.825064968397052*^9, 3.8250652855414248`*^9, {
   3.825066038626746*^9, 3.825066055934104*^9}, {3.8250728530744743`*^9, 
   3.8250728581358013`*^9}, {3.825072911882518*^9, 3.825072943181905*^9}, {
   3.825073062941679*^9, 3.8250730940906076`*^9}, 3.8268910929792085`*^9, {
   3.826891184589816*^9, 3.826891273248124*^9}, {3.8268914296469555`*^9, 
   3.826891431743919*^9}, 3.8268914679882364`*^9, {3.8355434854085155`*^9, 
   3.8355434978482437`*^9}, {3.835543634911148*^9, 3.8355436561778603`*^9}, 
   3.835543688555817*^9, {3.8355437186203365`*^9, 3.8355437401201224`*^9}, {
   3.835551495057995*^9, 3.8355514987390366`*^9}, {3.8355515825254993`*^9, 
   3.8355515837949696`*^9}, {3.8356210603605585`*^9, 
   3.835621082217616*^9}},ExpressionUUID->"26f372de-9c31-4d9e-8bd2-\
0aacf5e07a60"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"nbar", ",", "\[Rho]temp", ",", "\[Rho]\[Theta]"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"nbar", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]temp", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], "*", "nbar", "*", "\[Theta]"}], "]"}], "/", 
         "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "nbar", "*", "\[Theta]"}], "]"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]\[Theta]", "[", "\[Theta]", "]"}], "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"\[Rho]temp", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"\[Rho]temp", "[", "\[Theta]", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]\[Theta]", "[", "\[Theta]", "]"}], "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"\[Rho]temp", "[", "\[Theta]", "]"}], ",", 
       RowBox[{"\[Rho]\[Theta]", "[", "\[Theta]", "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"\[Mu]", "-", "2"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.817231011361639*^9, 3.817231019632612*^9}, {
   3.817231539732112*^9, 3.8172318130827694`*^9}, {3.817232041435583*^9, 
   3.8172320624640307`*^9}, {3.817232235182582*^9, 3.8172322675294228`*^9}, {
   3.8172323983898363`*^9, 3.8172323987058587`*^9}, {3.8172324540341635`*^9, 
   3.8172324592404723`*^9}, {3.8172325518477707`*^9, 3.817232673192151*^9}, {
   3.8172327685765123`*^9, 3.8172327764678965`*^9}, {3.817232812123248*^9, 
   3.8172328382303715`*^9}, {3.817232879496555*^9, 3.817232917071907*^9}, {
   3.8172330688869343`*^9, 3.817233101257606*^9}, 3.817233230341447*^9, {
   3.817233299885683*^9, 3.8172334550621214`*^9}, {3.822600602408382*^9, 
   3.8226006298354654`*^9}, {3.8226006765030003`*^9, 3.822600687443347*^9}, {
   3.8226007236837263`*^9, 3.8226007247458887`*^9}, {3.823878452924839*^9, 
   3.823878455401353*^9}, {3.825063186228921*^9, 3.825063200298081*^9}, {
   3.825063243307034*^9, 3.825063348523202*^9}, {3.8250643950303097`*^9, 
   3.825064398305263*^9}, 3.825064968397052*^9, 3.8250652855414248`*^9, {
   3.825066038626746*^9, 3.825066055934104*^9}, {3.8250728530744743`*^9, 
   3.8250728581358013`*^9}, {3.825072911882518*^9, 3.825072943181905*^9}, {
   3.825073062941679*^9, 3.8250730940906076`*^9}, 3.8268910929792085`*^9, {
   3.826891184589816*^9, 3.826891273248124*^9}, {3.8268914296469555`*^9, 
   3.826891431743919*^9}, 3.8268914679882364`*^9, {3.8355434854085155`*^9, 
   3.8355434978482437`*^9}, {3.835543634911148*^9, 3.8355436561778603`*^9}, 
   3.835543688555817*^9, 3.8355437186203365`*^9, {3.835543810371176*^9, 
   3.8355438130761027`*^9}, 3.8356210427892275`*^9, {3.8356210850244684`*^9, 
   3.8356211387205753`*^9}, {3.8356212597610416`*^9, 3.835621297115419*^9}, {
   3.8356220993375635`*^9, 3.8356221110830936`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"0706d23d-47fb-4480-a774-e195135366e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prior probability", "Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.8356217858820906`*^9, 3.8356217874564753`*^9}},
 FontSize->18,ExpressionUUID->"11771dbb-ccb1-4e3a-9cc0-f8156aa6f891"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"priorwidth", ",", "priormean", ",", "a", ",", "b", ",", "prior"}], 
  "]"}], "\n", 
 RowBox[{
  RowBox[{"priorwidth", "=", 
   RowBox[{"Pi", "/", "2."}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"priormean", "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"priormean", "-", 
    RowBox[{"priorwidth", "/", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"priormean", "+", 
    RowBox[{"priorwidth", "/", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"prior", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"b", "-", "a"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.8355443003524675`*^9, 3.835544311743806*^9}, 
   3.835544446392237*^9, 3.835544607522483*^9, {3.835621791615223*^9, 
   3.83562180423499*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"fd4396ae-9566-4126-add3-3f013a9aff62"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculation of \[Rho] and its diagonal form", "Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.8356217858820906`*^9, 3.8356217874564753`*^9}, {3.8356218918912086`*^9, 
   3.8356219039062557`*^9}},
 FontSize->18,ExpressionUUID->"dcc62a7e-4e78-42c7-bdcd-b8b3df56dd15"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Rho]", ",", "\[Rho]diag"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"prior", "[", "\[Theta]", "]"}], "*", 
      RowBox[{"\[Rho]\[Theta]", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "a", ",", "b"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]diag", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Eigenvalues", "[", "\[Rho]", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.8355443003524675`*^9, 3.835544311743806*^9}, 
   3.835544446392237*^9, 3.835544607522483*^9, {3.835621791615223*^9, 
   3.83562180423499*^9}, {3.835621911181116*^9, 3.8356219325211163`*^9}, 
   3.835621965647807*^9, {3.835622048849385*^9, 3.8356220935791683`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"a80238fd-d4b4-443c-9046-3e8206fc382d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculation of \[Rho]bar and its form in the eigenbasis of \[Rho]", \
"Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.8356217858820906`*^9, 3.8356217874564753`*^9}, {3.8356218918912086`*^9, 
   3.8356219039062557`*^9}, {3.835621947474238*^9, 3.8356219568570695`*^9}, {
   3.8356221192244005`*^9, 3.8356221204184427`*^9}},
 FontSize->18,ExpressionUUID->"716fb643-77c5-4dcc-8446-923f25b2f55f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Rho]bar", ",", "change", ",", "\[Rho]bardiag"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]bar", "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"prior", "[", "\[Theta]", "]"}], "*", 
      RowBox[{"\[Rho]\[Theta]", "[", "\[Theta]", "]"}], "*", "\[Theta]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "a", ",", "b"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"change", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Eigenvectors", "[", "\[Rho]", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]bardiag", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "change", "]"}], ".", "\[Rho]bar", ".", 
    "change"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.8355443003524675`*^9, 3.835544311743806*^9}, 
   3.835544446392237*^9, 3.835544607522483*^9, {3.835621791615223*^9, 
   3.83562180423499*^9}, {3.835621911181116*^9, 3.8356219325211163`*^9}, {
   3.8356219714639463`*^9, 3.835622001065504*^9}, 3.83562205271692*^9, 
   3.835622325385705*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"195dfe84-b63c-4953-ba3c-d678ca8e5751"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimal quantum estimator", "Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.8356217858820906`*^9, 3.8356217874564753`*^9}, {3.8356218918912086`*^9, 
   3.8356219039062557`*^9}, {3.835621947474238*^9, 3.8356219568570695`*^9}, {
   3.8356221192244005`*^9, 3.8356221310422783`*^9}},
 FontSize->18,ExpressionUUID->"475b30f3-0571-4954-8911-eb1ee4adbd4c"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Rho]supp", ",", "\[Rho]barsupp", ",", "Sopt"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]supp", "=", 
   RowBox[{"\[Rho]diag", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", 
       RowBox[{"MatrixRank", "[", "\[Rho]", "]"}]}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"MatrixRank", "[", "\[Rho]", "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]barsupp", "=", 
   RowBox[{"\[Rho]bardiag", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", 
       RowBox[{"MatrixRank", "[", "\[Rho]", "]"}]}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"MatrixRank", "[", "\[Rho]", "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Sopt", "=", 
   RowBox[{"LyapunovSolve", "[", 
    RowBox[{
     RowBox[{"\[Rho]supp", "/", "2."}], ",", 
     RowBox[{"\[Rho]supp", "/", "2."}], ",", "\[Rho]barsupp"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.8355443003524675`*^9, 3.835544311743806*^9}, 
   3.835544446392237*^9, 3.835544607522483*^9, {3.835621791615223*^9, 
   3.83562180423499*^9}, {3.835621911181116*^9, 3.8356219325211163`*^9}, {
   3.8356219714639463`*^9, 3.835622001065504*^9}, 3.83562205271692*^9, {
   3.835622136780678*^9, 3.835622161872635*^9}, {3.8356222119463625`*^9, 
   3.8356222264213433`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"e88e2a6b-e225-4314-b0db-072a5e8269fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Single-shot minimum mean square error", "Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.8356217858820906`*^9, 3.8356217874564753`*^9}, {3.8356218918912086`*^9, 
   3.8356219039062557`*^9}, {3.835621947474238*^9, 3.8356219568570695`*^9}, {
   3.8356221192244005`*^9, 3.8356221310422783`*^9}, {3.835622338444332*^9, 
   3.8356223461052713`*^9}},
 FontSize->18,ExpressionUUID->"daf06178-5c43-469a-a239-f136da5d3964"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Epsilon]mse", "]"}], "\n", 
 RowBox[{"\[Epsilon]mse", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"prior", "[", "\[Theta]", "]"}], "*", 
        RowBox[{"\[Theta]", "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "a", ",", "b"}], "}"}]}], "]"}], "-", 
     RowBox[{"Tr", "[", 
      RowBox[{"Sopt", ".", "Sopt", ".", "\[Rho]supp"}], "]"}]}], ",", 
    RowBox[{"10.", "^", 
     RowBox[{"(", 
      RowBox[{"-", "7"}], ")"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.8355443003524675`*^9, 3.835544311743806*^9}, 
   3.835544446392237*^9, 3.835544607522483*^9, {3.835621791615223*^9, 
   3.83562180423499*^9}, {3.835621911181116*^9, 3.8356219325211163`*^9}, {
   3.8356219714639463`*^9, 3.835622001065504*^9}, 3.83562205271692*^9, {
   3.835622136780678*^9, 3.835622161872635*^9}, {3.8356222119463625`*^9, 
   3.8356222264213433`*^9}, {3.8356223583006225`*^9, 3.8356224162040443`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"9e3d99a1-f72c-44e8-89cf-6c95d628d335"],

Cell[BoxData["0.0428159`"], "Output",
 CellChangeTimes->{{3.83562241336681*^9, 3.8356224269521666`*^9}},
 CellLabel->
  "Out[124]=",ExpressionUUID->"5e9bd38c-b60e-418c-bbdd-ed92b509a39f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1341, 919},
WindowMargins->{{107, Automatic}, {Automatic, 17}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.2 para Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"14a5c89b-a2f1-4317-961f-ca5ca40f8408"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1324, 20, 71, "Title",ExpressionUUID->"767000d7-785a-403a-8259-7ce916f377d8"],
Cell[CellGroupData[{
Cell[1929, 46, 969, 13, 51, "Subsection",ExpressionUUID->"134ecbef-2767-4da9-8220-3c2c8a245531"],
Cell[2901, 61, 1085, 15, 34, "Text",ExpressionUUID->"26e2b967-9acc-4da8-bbff-c142cf2213e7"],
Cell[3989, 78, 1105, 17, 48, "Input",ExpressionUUID->"6a2732ea-f01e-44e8-8df7-09eb9a0ca45b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5131, 100, 1701, 22, 51, "Subsection",ExpressionUUID->"39df1cf5-81b2-4abf-9855-8dae42055d50"],
Cell[6835, 124, 1896, 26, 34, "Text",ExpressionUUID->"26f372de-9c31-4d9e-8bd2-0aacf5e07a60"],
Cell[8734, 152, 3335, 69, 105, "Input",ExpressionUUID->"0706d23d-47fb-4480-a774-e195135366e1"]
}, Open  ]], 
Cell[CellGroupData[{
Cell[12106, 226, 760, 10, 51, "Subsection",ExpressionUUID->"11771dbb-ccb1-4e3a-9cc0-f8156aa6f891"],
Cell[12869, 238, 1311, 32, 124, "Input",ExpressionUUID->"fd4396ae-9566-4126-add3-3f013a9aff62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14217, 275, 840, 11, 51, "Subsection",ExpressionUUID->"dcc62a7e-4e78-42c7-bdcd-b8b3df56dd15"],
Cell[15060, 288, 1302, 26, 67, "Input",ExpressionUUID->"a80238fd-d4b4-443c-9046-3e8206fc382d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16399, 319, 966, 13, 51, "Subsection",ExpressionUUID->"716fb643-77c5-4dcc-8446-923f25b2f55f"],
Cell[17368, 334, 1522, 33, 86, "Input",ExpressionUUID->"195dfe84-b63c-4953-ba3c-d678ca8e5751"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18927, 372, 924, 12, 51, "Subsection",ExpressionUUID->"475b30f3-0571-4954-8911-eb1ee4adbd4c"],
Cell[19854, 386, 1813, 42, 86, "Input",ExpressionUUID->"e88e2a6b-e225-4314-b0db-072a5e8269fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21704, 433, 988, 13, 51, "Subsection",ExpressionUUID->"daf06178-5c43-469a-a239-f136da5d3964"],
Cell[CellGroupData[{
Cell[22717, 450, 1509, 30, 48, "Input",ExpressionUUID->"9e3d99a1-f72c-44e8-89cf-6c95d628d335"],
Cell[24229, 482, 187, 3, 32, "Output",ExpressionUUID->"5e9bd38c-b60e-418c-bbdd-ed92b509a39f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

